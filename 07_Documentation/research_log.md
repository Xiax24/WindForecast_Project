# 风电场风速预报研究日志

## 2025年5月18日 - 项目启动

### 今日完成工作

1. **项目框架建立**
   - 创建了完整的项目文件夹结构，包括数据、代码、结果等主要目录
   - 设置了项目README.md，明确了研究目标和方法
   - 创建了requirements.txt记录项目依赖

2. **开发环境配置**
   - 创建了名为"windforecast"的conda环境
   - 安装了核心分析库：pandas, numpy, scikit-learn等
   - 解决了wrf-python在M系列Mac上的安装问题，采用替代方案

3. **Git版本控制设置**
   - 初始化了本地Git仓库
   - 创建了.gitignore文件，排除了数据文件和临时文件
   - 准备连接到GitHub远程仓库

### 遇到的问题与解决方案

1. **wrf-python安装问题**
   - 问题：conda无法在M系列Mac上找到wrf-python包
   - 解决方案：决定使用netCDF4和xarray直接处理WRF输出文件，或考虑使用x86_64环境

2. **项目范围界定**
   - 问题：研究内容广泛，需要明确优先级
   - 解决方案：决定首先聚焦于稳定度分类和边界层结构分析

### 观察与思考

- 项目框架设置比预期花费了更多时间，但这是值得的长期投资（倒也不至于，就是自己摸鱼了🦑了一段时间）
- 需要进一步了解数据格式和结构，特别是WRF输出的组织方式
- 考虑采用增量开发策略，先实现基础分析功能，再逐步添加高级方法

### 下一步计划

1. **数据探索（明天）**
   - 加载样本数据，了解数据结构和格式
   - 创建基本可视化，观察风速时间序列特征
   - 评估数据质量和缺失情况

2. **基础函数开发（明天-后天）**
   - 实现数据加载和预处理功能
   - 编写风切变参数计算函数
   - 开发初步的稳定度分类方法

3. **本周目标**
   - 完成数据预处理流程
   - 实现基本的稳定度分析
   - 生成初步的GFS vs EC误差统计

### 资源与参考

项目结构参考：[Standard ML Project Structure](https://github.com/example/project)

稳定度分类方法参考：
- #### 支持风切变参数(α)稳定度分类的核心文献
- Irwin, J.S. (1979). "A theoretical variation of the wind profile power-law exponent as a function of surface roughness and stability." Atmospheric Environment, 13(1), 191-194.
该文章建立了风切变指数α与大气稳定度之间的理论关系
提供了不同稳定度条件下α值的理论范围
- Wharton, S., & Lundquist, J.K. (2012). "Atmospheric stability affects wind turbine power collection." Environmental Research Letters, 7(1), 014005.
专门针对风能应用研究稳定度分类方法
验证了α值在风电场环境中作为稳定度指标的有效性
提供了稳定度与风电机组性能关系的实证分析

- Emeis, S. (2013). "Wind energy meteorology: atmospheric physics for wind power generation." Springer.
该专著3.2节详细讨论了风切变参数与稳定度的关系
提供了α值分类稳定度的标准阈值
讨论了该方法在风能领域的广泛应用
- Peña, A., Gryning, S.E., & Hasager, C.B. (2010). "Comparing mixing-length models of the diabatic wind profile over homogeneous terrain." Theoretical and Applied Climatology, 100(3-4), 325-335.
比较了不同稳定度条件下的风剖面模型
验证了α值变化与温度梯度变化的一致性
提供了风切变参数用于稳定度分类的实证支持
- Newman, J.F., & Klein, P.M. (2014). "The impacts of atmospheric stability on the accuracy of wind speed extrapolation methods." Resources, 3(1), 81-105.
研究了不同稳定度下风速外推方法的准确性
验证了风切变参数与Richardson数和Obukhov长度的相关性
支持在缺乏温度梯度数据时使用风切变参数作为替代

- #### 多因素辅助判断的支持文献

- Barthelmie, R.J., Palutikof, J.P., & Davies, T.D. (1993). "Estimation of sector roughness and the effect on prediction of the vertical wind speed profile." Boundary-Layer Meteorology, 66(1-2), 19-47.
讨论了结合多种因素(包括时间、风向等)提高稳定度分类准确性的方法
提供了综合判断框架的实证基础


- Gualtieri, G. (2019). "A comprehensive review on wind resource extrapolation models applied in wind energy." Renewable and Sustainable Energy Reviews, 102, 215-233.
综述了风能领域使用的各种稳定度分类方法
讨论了在数据有限情况下的替代方法和组合策略
支持在仅有单层温度数据时使用风切变参数为主的组合方法


- Risan, A., Lund, J.A., Chang, C.Y., & Sætran, L. (2018). "Wind in complex terrain - lidar measurements for evaluation of CFD simulations." Remote Sensing, 10(1), 59.
讨论了复杂地形中的稳定度估计方法
验证了风剖面特征作为稳定度指标的有效性
证明了在缺少温度梯度情况下风切变参数的适用性

- #### 方法优化和验证的关键文献

- Optis, M., Monahan, A., & Bosveld, F.C. (2016). "Limitations and breakdown of Monin–Obukhov similarity theory for wind profile extrapolation under stable stratification." Wind Energy, 19(6), 1053-1072.
详细讨论了稳定条件下风剖面特征
提供了优化风切变参数使用的指导
讨论了该方法的局限性和适用条件


- Argyle, P., & Watson, S. (2014). "Assessing the dependence of surface layer atmospheric stability on measurement height at offshore locations." Journal of Wind Engineering and Industrial Aerodynamics, 131, 88-99.
研究了测量高度对稳定度评估的影响
验证了70m/10m高度对作为计算α值的有效性
提供了提高α值方法准确性的实用建议


## 2025年5月20日 - 观测数据处理完成

### 今日完成工作

1. **观测数据清洗与处理**
   - 完成了3个风电场/测风塔的观测数据处理：
     - **昌马测风塔** (`changma`)：2021-05-01至2022-10-31，548天数据
     - **三十里井子风电场** (`sanlijijingzi`)：2021-06-01至2022-06-16，381天数据  
     - **矿区风电场** (`kuangqu`)：数据已处理完成
   - 实现了多高度层数据整合（10m, 30m, 50m, 70m）
   - 建立了标准化的宽格式数据结构

2. **数据质量控制系统**
   - 实现了多层次异常值检测：
     - 极值检查（风速>50m/s, 温度范围等）
     - 范围检查（风向0-360°等）
     - **僵值检测**：创新性地实现了连续5个相同数值的僵值识别和清理
   - 建立了缺失值标记识别系统（-99, NULL等多种格式）
   - 生成了详细的数据质量报告和统计摘要

3. **时间序列标准化**
   - 处理了复杂的时间格式（分列日期时间vs合并datetime）
   - 实现了智能重采样算法：
     - **风向**：圆形平均算法（解决0°/360°边界问题）
     - **风速变量**：按类型分别处理（平均/最大/最小/瞬时）
     - **气象变量**：标准算术平均
   - 生成了15分钟标准间隔数据产品

4. **文件组织与管理**
   - 建立了清晰的数据产品层次：
     - `cleaned_original/`：原始时间分辨率清洗数据
     - `cleaned-15min/`：15分钟标准间隔数据
   - 每个数据产品都包含详细的处理摘要和元数据

### 技术创新点

1. **僵值检测算法**
   - 基于时间序列分组，识别连续相同数值
   - 参数可调（默认5个连续值）
   - 适用于传感器故障导致的数据冻结问题

2. **多变量智能重采样**
   - 不同类型变量采用最适合的聚合方法
   - 风向使用圆形平均，避免角度计算错误
   - 保持了原始数据的物理意义

3. **分离式数据架构**
   - 原始清洗数据：保持最大信息量，用于详细分析
   - 15分钟标准数据：便于与NWP等外部数据对比

### 数据质量成果

**昌马测风塔（示例）**：
- 数据完整性：风速数据99.9%，风向数据99.9%
- 52,608个时间点（15分钟间隔后约17,536个）
- 4个高度层全部成功处理

**三十里井子风电场（示例）**：
- 包含了更丰富的风速指标：平均、最大、最小、瞬时、标准差
- 风向包含平均风向和瞬时风向
- 数据压缩比3:1（5分钟→15分钟）

### 遇到的挑战与解决方案

1. **数据格式不一致**
   - 挑战：不同风电场使用不同的时间列格式
   - 解决：开发了灵活的时间解析系统，支持分列和合并格式

2. **传感器异常数据**
   - 挑战：发现大量连续相同的异常数值（传感器卡住）
   - 解决：开发僵值检测算法，自动识别和清理

3. **风向数据处理**
   - 挑战：风向的圆形特性导致传统平均值计算错误
   - 解决：实现圆形平均算法，正确处理跨越0°/360°的情况

### 观察与分析

- **数据质量总体良好**：3个站点的主要变量完整性都超过99%
- **僵值问题较为常见**：所有站点都发现了传感器僵值，验证了检测算法的必要性
- **三十里井子数据最丰富**：包含了更多风速指标，有利于后续湍流分析

### 下一步计划

1. **数据探索分析（明天）**
   - 生成风况统计和可视化
   - 分析不同高度层的风切变特征
   - 评估3个站点的风资源质量

2. **与NWP数据对比（本周）**
   - 下载对应时期的GFS/EC数据
   - 建立时空匹配系统
   - 开始预报误差统计分析

3. **稳定度分析准备**
   - 利用多高度风速数据计算风切变参数α
   - 结合时间和季节信息进行稳定度初步分类
   - 为后续详细分析建立基础


## 2025年5月22日 - 物理过程分析规划

### 今日完成工作

1. **数据匹配系统成功运行**
   - ✅ 观测-WRF数据匹配系统完全修正并成功运行
   - ✅ 解决了温度单位问题（K → °C）
   - ✅ 解决了密度计算问题（重新从温度气压计算）
   - ✅ 生成了完整的统计对比分析报告

2. **初步结果分析**
   - ✅ 获得了三个站点的EC vs GFS对比结果
   - ✅ 发现EC-WRF在大多数情况下表现更优
   - ✅ 昌马站：EC优势70%，三十里井子：EC优势75%，矿区：GFS优势66.7%

3. **物理过程分析框架讨论**
   - ✅ 明确了研究重点：挖掘EC vs GFS差异的物理条件和原因
   - ✅ 确定了逐站点分析的实用方法
   - ✅ 梳理了各站点可计算的延伸物理变量

### 关键发现与洞察

#### **EC-WRF优势模式**
- **昌马站**：风速预报全面优胜，改善3.5%-5.7%
- **三十里井子站**：风速预报全面优胜，改善2.1%-3.4% 
- **矿区站**：GFS略优，但差异很小（0.2%-1.0%）

#### **需要深入分析的问题**
- 为什么EC-WRF在复杂地形站点（昌马、三十里井子）表现更优？
- 什么物理条件下EC vs GFS差异最显著？
- 预报误差的根本物理来源是什么？

### 明日计划重点

#### **物理变量计算优先级**

**第一批（基础核心变量）**：
1. **大气稳定度计算**
   - 基于文献方法的风切变参数α
   - 稳定度分类：不稳定(<0.1)、中性(0.1-0.3)、稳定(>0.3)
   - 结合时间因子的辅助判断

2. **风向深度分析**
   - 16方位风玫瑰图
   - 各风向的EC vs GFS误差对比
   - 风向变化性和持续性

3. **Wind Ramp指标**（重要！）
   - Wind Ramp Rate: dV/dt
   - Ramp Magnitude和Duration
   - 仅三十里井子站可计算（有标准差数据）

4. **温湿度物理量**（昌马站）
   - 露点温度、饱和差
   - 天气过程表征指标

**第二批（机制分析变量）**：
5. 边界层高度估算（基于风速剖面法）
6. 表面粗糙度计算
7. 天气过程识别指标

#### **研究目标层次化**
- **Level 1**: 差异识别 - EC vs GFS具体差异条件
- **Level 2**: 机制揭示 - 预报误差的物理来源
- **Level 3**: 改进指导 - 智能模式选择和误差订正

### 各站点数据特点回顾

#### **昌马站**（数据最丰富）
- 风速风向：10m, 30m, 50m, 70m 
- 气象数据：10m温度、湿度、密度
- **可计算**：完整稳定度、温湿度指标、边界层特征

#### **矿区站**（数据中等）
- 风速风向：30m, 50m, 70m
- **可计算**：30-70m风切变、稳定度（受限）

#### **三十里井子站**（湍流数据丰富）
- 风速：10-70m（平均、最大、最小、标准差）
- 风向：10-70m
- **可计算**：湍流强度、阵风因子、Wind Ramp指标

### 技术问题解决记录

1. **温度单位修正**：WRF温度从开尔文正确转换为摄氏度
2. **密度重计算**：使用理想气体定律从温度气压重新计算
3. **时间对齐**：观测与WRF数据精确匹配，获得高质量对比数据

### 文献方法应用

- **稳定度分类**：Emeis (2013), Wharton & Lundquist (2012)方法
- **边界层高度**：基于风速剖面偏离对数关系的方法
- **Wind Ramp**：国际风能研究的标准指标

### 研究价值提升

通过今天讨论，研究目标从简单的"模式对比"提升为：
1. **揭示预报误差的物理机制**
2. **提供针对性改进建议**
3. **开发智能预报策略**

这将显著增强研究的科学价值和实用意义。

---

## 下一步行动

### 明日待办
1. 实现第一批物理变量计算代码
2. 先从昌马站开始详细分析
3. 生成风玫瑰误差对比图
4. 开始稳定度vs预报性能分析

### 本周目标
- 完成三个站点的基础物理变量计算
- 初步识别EC优势的关键物理条件
- 生成机制分析的核心图表

---

**研究状态**：✅ 数据基础完善，ready for 深度物理分析

**今日工作时长**：约6小时（数据修正 + 系统优化 + 分析规划）

**明日重点**：物理变量计算实现